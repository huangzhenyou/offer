#基于AIS系统tanker-vlcc&&vloc型船舶动态监测分析

通过AIS获得的静态原始数据和动态原始数据，识别tanker-vlcc的实时动态轨迹，结合全球范围内的原油输入国和输出国的港口信息，对vlcc船舶进行系统甄别，深入分析其所处位置、挂靠港口、航行状态、航行路径等，运用大数据挖掘相关理论实现实时tanker-vlcc的流量、流向分布，为挖掘即时运力分布与运价变化的内在规律做铺垫。



## 清洗原始数据

* 加入时间特征的船舶轨迹离线压缩算法来清洗原始数据—即快速Douglas-Peucker算法研究
* 每月的AIS数据大约300~400G





## 1.全球海岬型船舶的实时分布



### 1.1 任务描述与说明

可视化某一天vlcc船的分布情况，一条船用一个点表示。如果该船为空载在图上用绿点表示，否则用红点表示。

### 1.2 大数据分析步骤

读取某一天的AIS数据，如2016年9月15日的AIS。AIS数据中一条船会对应很多条数据，也就是多个数据点，但每条船只取一个数据，比如第一次出现的数据，这样每条船就会对应一个数据点。

接下来需要判断这条船为空载还是满载，进行如下步骤：

1.《vlcc0915.csv》文件中记录了本日所有vlcc船只的经纬度坐标，时间戳，IMO和mmis。将每条船按其时间戳进行升序排列，输出每条船的第一条数据，输出文件名为《vlcc0915first.csv》。

2.《cx_201609_moor_py2》文件为所有型号船舶2016-09的停泊事件，含有船舶mmis编号、时间戳和停泊港口，提取出此三列信息，输出文件《cx-201609-03.csv》。

3.将《vlcc0915first.csv》中的每条船按如下规则在《cx-201609-03.csv》中筛选：

比如《vlcc0915first.csv》中mmis编号为A的船时间戳为14666666，在《cx-201609-03.csv》中定位mmis编号为A的船，然后将A船的时间戳14666666与A船的停泊事件中的时间戳逐个进行比对，输出时间戳1466666的前一个和后一个时间戳对应的港口且该停泊港口名不为none。输出文件《vlcc0915-cx.csv》。                  

4.《oil-port-zhou.csv》文件包含country和PortName，分别是国家名和国家对应的港口名，以及各国进口出口原油的情况，c为输出国，j为进口国，z为中转国。然后使用文件《oil-port-zhou.csv》与《vlcc0915-cx.csv》匹配，做如下判断：

（1）若前一个港口为c则无论后一个港口是什么，则将这条船判断为满载，将它的经纬度坐标，船舶mmis号等信息输出到文件名为《m.csv》中。    

（2）若前一个港口为j则无论后一个港口是什么，则将这条船判断为空载，输出相应信息到《k.csv》中。      

（3）若前一个港口为z，则zc为空载，zj为满载，分别输入前述相应文件；若为zz，输出相应的船舶信息到文件《p.csv》

（4）对于只有一条数据的情况，如果是前一个港口输出为c则满载文件，输出j为空载文件，z输出为p.csv文件。如果是后一个港口c为空，j为满，z为P文件

5.空载文件《k.csv》中的点用绿色表示，满载文件《m.csv》中的点用绿色表示；中转文件《p.csv》中的点取一半表示为黄色，，做出空满载图。

6.为了描述某天的情况，取2016年9月15日8点1473897600，16点1473926400，24点1473955200。提取船舶最接近这三个时间点前的一条动态经纬度数据，分别进行上面判断，然后做图。

### 1.3 数据分析的开发环境和源代码

Python：文件夹1

 

R：文件夹1

## 2. 全球海岬型船舶航线密度

### 2.1 任务描述与说明

提取tanker-vlcc的AIS数据，把每条tanker-vlcc的航行轨迹在图上展示出来，用航行轨迹代表航线，所有tanker-vlcc的航线轨迹在图上可以直接反映航线密度。

### 2.2 大数据分析方法与思路

在2016年7月至2016年9月所有船的AIS动态数据中提取属于tanker-vlcc的数据，文件《zh2016-07.csv》《zh2016-08.csv》《zh2016-09.csv》为各月tanker-vlcc的动态数据总和，对于每条船AIS，按照时间排序，经纬度位置依次连接就构成该船的航线轨迹。

在连接轨迹线前对数据进行清洗，输出文件《vlcc7-9.csv》：

（1）这些轨迹表现在图上时，可能会由于数据缺失，导致相隔距离较远的两位置点间直接用直线相连，采用的解决方法是若相邻两点间的经纬度距离大于速度（8.75 m/s）* 时间，则这两条数据属于不合理数据，则删除后一条数据，依次对各条数据进行判断。

（2）轨迹画在地图上时，还有一个问题是经度-180会直接连接经度+180，会出现横跨大陆的情况，处理方法是分成两段。

### 2.3 数据分析的开发环境和源代码

Python：文件2

 

R：文件2

## 3. 全球tanker-vlcc流向与流量分布

### 3.1任务描述与说明

可视化全球tanker-vlcc的2016.07-09的流向与流量分布。

### 3.2步骤

1. 找出停泊事件文件《cx_201607_moor_py2》、《cx_201608_moor_py2》和《cx_201609_moor_py2》中所有属于tanker-vlcc的停泊事件（根据《vlcc07.csv》《vlcc08.csv》《vlcc09.csv》中的mmis号直接匹配即可），并去掉其中停泊港口名为none的行并合并成一个文件，输出文件《liuliang7-9.csv》。

2.《oil-port-zhou.csv》和《liuliang7-9.csv》匹配，在《liuliang7-9.csv》原有数据基础上补充上国家所属大洲和属性信息。每条船按时间戳排列，然后将相邻前后行大洲相同、国家相同且国家属性相同的行合并，然后对每组tanker-vlcc进行筛选分类：

（1）将每组中同时含有c,j的归为A类，输出文件《A.csv》。

（2）将每组中含有c,z且不含有j的归为B类，输出文件《B.csv》。

（3）将每组中含有z,j且不含有c的归为C类，输出文件《C.csv》。

（4）将其余各项归为D类，输出文件《D.csv》。

\3. 对于每组船舶按时间戳顺序依次读取每行停泊港口并进行如下判断，对于每条船一次输油的起始点分开表示，起点用o,重点用d表示，《zhou_to_zhou_time.csv》为最终流量汇总：

（1）A类:  人工判断

（2）B类：数据量不大，人工判断基本规则，与（4）类似。输出文件《shaiB.csv》。 

（3）C类：多z第一个，多j最后一个，输出文件《shaiC.csv》。 

（4）D类: 对于只有1条大洲信息的船舶忽略不计，对于有两条以上相同属性但大洲不同的船舶，根据各大洲输油特性进行人工判断。多个洲的情况：对于主要输油国或主要进口国的多个选取最后一个或第一个。

（人为辅助规则：认为西非，中东，南美主要输油，主要出口地美国，欧洲，中国为代表的亚太地区；伊朗对埃及供油；英国出口；印度尼西亚Indonesia出口原油；南非是有纯进口）

## 4. VLCC全球动态分布与主要路径分析

### 4.1 任务描述与说明

同2中的方法做出对比图，在AIS动态数据中提取tanker-vlcc船2015年7月到9月的动态数据，每条船的位置点依次连接构成航行轨迹。

### 4.2 大数据分析方法与思路

同2方法

### 4.3 数据分析的开发环境和源代码

Python：文件4

 

R：文件4

## 5. 全球vlcc型船舶港口排名，靠泊热力图分布

### 5.1 任务描述与说明

可视化全球tanker-vlcc船停靠港口的停靠次数和热度

### 5.2 采用的原始数据和数据格式说明

统计2016年7月至2016年9月 tanker-vlcc船的停泊事件中的各港口出现的次数和个港口的经纬度坐标，每条船舶按时间顺序排列，合并前后相邻且港口名相同的行。

画出热力图和条形图（excel）
![img](file:///C:\Users\hzy\AppData\Local\Temp\ksohtml\wps7EBC.tmp.jpg)

### 5.3 数据分析的开发环境和源代码

Python：文件5

 

### 6.数据来源

6.1国家进出口属性来源

因tanker-vlcc船主要运输货物为原油，在判断一个国家为原油出口国还是原油进口国时，采用原油进出口量作为参考依据，参考各国2016年的原油进出口量进行判断，数据来源网页如下：

进口：<https://translate.google.co.jp/translate?hl=zh-CN&sl=en&u=http://www.worldstopexports.com/crude-oil-imports-by-country/&prev=search>

出口：<https://translate.google.co.jp/translate?hl=zh-CN&sl=en&u=http://www.worldstopexports.com/worlds-top-oil-exports-country/&prev=search>

上述网页表格中没有数据的国家采用the CIA world factbook中的数据作为参考，此类数据多为2012、2013等某年份该国家每天进出口原油的桶数，APP如下图所示：

![img](file:///C:\Users\hzy\AppData\Local\Temp\ksohtml\wps7ECD.tmp.png) 

​    上述两处数据整理后，仍没有数据的国家或在APP中进出口桶数均为0的国家，认为是进口国处理。有数据可参考的国家，若进出口量两者之间呈现两倍及以上倍数关系，则认为大的一方为该国进出口的主要类型，在type中进口赋值j，出口赋值c；若没有前述关系，则认为该国为中转国，赋值z。

第二部分中船舶速度，经查证tanker-vlcc船服务速度在15.5节左右，试航速度在16.5节左右，因此在判断经纬度间距离是否合理时，取17节作为船速判断依据，并换算成单位m/s。

6.2原始代码的前期处理

（1）从2016年7-9月停泊时间《cx_201607_moor_py2》、《cx_201608_moor_py2》、《cx_201609_moor_py2》取三列得到：《cx-201607-03.csv》、《cx-201608-03.csv》、《cx-201609-03.csv》含有mmis、begin-time、now-port信息且港口名不为none。

（2）从7-9静态数据、动态数据、《IMO+Summary+_To+Kern+Xu》中匹配提取出每月每天vlcc船的动态数据《vlcc0901.csv》等，并将每月数据整合《zh2016-07.csv》等。数据所在文件夹《vlcc201607-09》，代码《gro.py》。

（3）将“《cx-201607-03.csv》、《cx-201608-03.csv》、《cx-201609-03.csv》”与“《zh2016-07.csv》、《zh2016-08.csv》、《zh2016-09.csv》”匹配，得出属于vlcc船的停泊事件：《vlcc-cx-201607.csv》，《vlcc-cx-201608.csv》，《vlcc-cx-201609.csv》。

（4）将《zhou.xlsx》和《石油-port.csv》合并成《oil-port-zhou.csv》。

（5）将《oil-port-zhou.csv》和“《vlcc-cx-201607.csv》，《vlcc-cx-201608.csv》，《vlcc-cx-201609.csv》”合并生成：《cx-zhouguo-201607.csv》，《cx-zhouguo-201608.csv》，《cx-zhouguo-201609.csv》。

（6）《201509vlcc.rar》中为2015年vlcc船动态数据，得到方法同前述2016年数据。

 